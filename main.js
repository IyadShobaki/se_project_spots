!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitBtnSelector:".modal__submit-btn",inactiveBtnClass:"modal__btn_disabled",inputErrorClass:"modal__input_type_error"},t=(e,t,r)=>{const n=e.querySelector(`.${t.id}-error`);t.classList.remove(r.inputErrorClass),n.textContent=""},r=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.classList.add(r.inactiveBtnClass),t.disabled=!0):(t.classList.remove(r.inactiveBtnClass),t.disabled=!1)};function n(e,t){const r=e.textContent.trim();e.textContent=t?r.slice(0,-1)+"ing...":r.slice(0,-6)+"e"}const o=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitalCards(),this.getUserInfo()])}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitalCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}createNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"3deb5cb0-25cc-41a0-b81d-23c312c12744","Content-Type":"application/json"}});let s;function a(){s.forEach(e=>{const t=function(e){const t=H.cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image");n.src=e.link,n.setAttribute("alt",e.name),r.textContent=e.name;const c=t.querySelector(".card__like-btn");e.isLiked&&c.classList.add("card__like-btn_active"),c.addEventListener("click",t=>function(e,t){o.toggleLike(t._id,t.isLiked).then(e=>{const r=s.findIndex(e=>e._id===t._id);s[r]=e,P.innerHTML="",a()}).catch(console.error)}(0,e));return t.querySelector(".card__delete-btn").addEventListener("click",()=>function(e,t){D=e,N=t._id,console.log(N),M(B)}(t,e)),n.addEventListener("click",()=>{w.textContent=e.name,I.src=e.link,I.alt=e.name,M($)}),t}(e);P.append(t)})}o.getAppInfo().then(([e,t])=>{s=e,a(),q.textContent=t.name,L.textContent=t.about,_.src=t.avatar}).catch(console.error);const c=document.querySelector(".profile__avatar-btn"),i=document.querySelector("#avatar-modal"),l=i.querySelector(".modal__close-btn"),d=i.querySelector(".modal__form"),u=i.querySelector(".modal__submit-btn"),m=i.querySelector("#profile-avatar-input"),_=document.querySelector(".profile__avatar"),h=document.querySelector(".profile__edit-btn"),f=document.querySelector("#edit-profile-modal"),p=f.querySelector(".modal__close-btn"),y=f.querySelector(".modal__submit-btn"),v=f.querySelector(".modal__form"),b=f.querySelector("#profile-name-input"),S=f.querySelector("#profile-description-input"),q=document.querySelector(".profile__title"),L=document.querySelector(".profile__description"),k=document.querySelector(".profile__new-post-btn"),E=document.querySelector("#new-post-modal"),C=E.querySelector(".modal__close-btn"),g=E.querySelector(".modal__submit-btn"),U=E.querySelector(".modal__form"),x=E.querySelector("#card-image-input"),T=E.querySelector("#card-caption-input"),$=document.querySelector("#preview-image-modal"),A=$.querySelector(".modal__close-btn"),I=$.querySelector(".modal__image"),w=$.querySelector(".modal__caption"),B=document.querySelector("#confirmation-modal"),R=B.querySelector(".modal__form");let D,N;const P=document.querySelector(".cards__list"),H=document.querySelector("#card-template").content.querySelector(".card");function M(e){e.classList.add("modal_is-opened"),document.addEventListener("keyup",j),e.addEventListener("mousedown",J)}function O(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keyup",j),e.removeEventListener("mousedown",J)}function j(e){"Escape"===e.key&&O(document.querySelector(".modal_is-opened"))}function J(e){e.target.classList.contains("modal")&&O(e.target)}var V;A.addEventListener("click",()=>{O($)}),h.addEventListener("click",function(){b.value=q.textContent,S.value=L.textContent,t(f,b,e),t(f,S,e),M(f)}),v.addEventListener("submit",function(t){if(!v.checkValidity())return;t.preventDefault();const r=t.submitter;n(r,!0),o.editUserInfo({name:b.value,about:S.value}).then(t=>{q.textContent=t.name,L.textContent=t.about,y.classList.add(e.inactiveBtnClass),O(f)}).catch(console.error).finally(()=>{n(r,!1)})}),p.addEventListener("click",function(){O(f)}),k.addEventListener("click",function(){M(E)}),U.addEventListener("submit",function(t){if(!U.checkValidity())return;t.preventDefault();const r=t.submitter;n(r,!0),o.createNewCard({name:T.value,link:x.value}).then(r=>{r.name,r.link,s.unshift(r),P.innerHTML="",a(),g.classList.add(e.inactiveBtnClass),t.target.reset(),O(E)}).catch(console.error).finally(()=>{n(r,!1)})}),C.addEventListener("click",function(){O(E)}),c.addEventListener("click",()=>{M(i)}),d.addEventListener("submit",function(t){if(!d.checkValidity())return;t.preventDefault();const r=t.submitter;n(r,!0),o.editAvatar(m.value).then(r=>{_.src=r.avatar,u.classList.add(e.inactiveBtnClass),t.target.reset(),O(i)}).catch(console.error).finally(()=>{n(r,!1)})}),l.addEventListener("click",()=>{O(i)}),R.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;n(t,!0),o.deleteCard(N).then(()=>{const e=s.findIndex(e=>e._id===N);s.splice(e,1),P.innerHTML="",a(),D="",N="",O(B)}).catch(console.error).finally(()=>{n(t,!1)})}),B.addEventListener("mousedown",e=>{(e.target.classList.contains("modal__close-btn")||e.target.classList.contains("modale__submit-btn_type_cancel"))&&(D="",N="",O(B))}),V=e,document.querySelectorAll(V.formSelector).forEach(e=>{((e,n)=>{const o=Array.from(e.querySelectorAll(n.inputSelector)),s=e.querySelector(n.submitBtnSelector);r(o,s,n),o.forEach(a=>{a.addEventListener("input",()=>{((e,r,n)=>{r.validity.valid?t(e,r,n):((e,t,r,n)=>{const o=e.querySelector(`.${t.id}-error`);t.classList.add(n.inputErrorClass),o.textContent=r})(e,r,r.validationMessage,n)})(e,a,n),r(o,s,n)})})})(e,V)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixFQUFPTixtQkFFcERhLEVBQWVDLEVBQVdDLEVBQVlULEdBRXRDUSxFQUFVb0QsUUFBUzdELElBQ2pCQSxFQUFhd0UsaUJBQWlCLFFBQVMsS0F0Q2hCMkUsRUFBQ3BKLEVBQWFDLEVBQWNDLEtBQ2hERCxFQUFhWSxTQUFTQyxNQVF6QmYsRUFBZUMsRUFBYUMsRUFBY0MsR0FyQnZCbUosRUFBQ3JKLEVBQWFDLEVBQWNxSixFQUFjcEosS0FDL0QsTUFBTUMsRUFBZUgsRUFBWUksY0FBYyxJQUFJSCxFQUFhSSxZQUNoRUosRUFBYUssVUFBVVUsSUFBSWQsRUFBT0osaUJBQ2xDSyxFQUFhSyxZQUFjOEksR0FXekJELENBQ0VySixFQUNBQyxFQUNBQSxFQUFhc0osa0JBQ2JySixJQWlDQWtKLENBQW1CcEosRUFBYUMsRUFBY0MsR0FDOUNPLEVBQWVDLEVBQVdDLEVBQVlULFFBU3hDK0ksQ0FBa0JqSixFQUFhRSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXIuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ0blNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ0bkNsYXNzOiBcIm1vZGFsX19idG5fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG59O1xuXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG59O1xuXG5leHBvcnQgY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoXG4gICAgICBmb3JtRWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudCxcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcbiAgICAgIGNvbmZpZ1xuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xuICB9KTtcbn07XG5cbmNvbnN0IHRvZ2dsZUJ0blN0YXRlID0gKGlucHV0TGlzdCwgYnRuRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGJ0bkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdG5DbGFzcyk7XG4gICAgYnRuRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIH0gZWxzZSB7XG4gICAgYnRuRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ0bkNsYXNzKTtcbiAgICBidG5FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gIH1cbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidG5FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnRuU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ0blN0YXRlKGlucHV0TGlzdCwgYnRuRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ0blN0YXRlKGlucHV0TGlzdCwgYnRuRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XG4gIH0pO1xufTtcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KGJ0biwgaXNMb2FkaW5nKSB7XG4gIGNvbnN0IHRleHQgPSBidG4udGV4dENvbnRlbnQudHJpbSgpO1xuXG4gIGlzTG9hZGluZ1xuICAgID8gKGJ0bi50ZXh0Q29udGVudCA9IHRleHQuc2xpY2UoMCwgLTEpICsgXCJpbmcuLi5cIilcbiAgICA6IChidG4udGV4dENvbnRlbnQgPSB0ZXh0LnNsaWNlKDAsIC02KSArIFwiZVwiKTtcbn1cbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICBoaWRlSW5wdXRFcnJvcixcbiAgc2V0dGluZ3MsXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL2FwaS5qc1wiO1xuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gXCIuLi91dGlscy9oZWxwZXIuanNcIjtcblxuLy8gQVBJXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIzZGViNWNiMC0yNWNjLTQxYTAtYjgxZC0yM2MzMTJjMTI3NDRcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBQb3B1bGF0ZSBjYXJkcyBhbmQgcHJvZmlsZSBBcGkgcmVxdWVzdFxubGV0IGNhcmRzQXJyYXk7XG5cbmZ1bmN0aW9uIHJlbG9hZENhcmRzKCkge1xuICBjYXJkc0FycmF5LmZvckVhY2goKGNhcmQpID0+IHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmQpO1xuICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xuICB9KTtcbn1cbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChbY2FyZHMsIHVzZXJdKSA9PiB7XG4gICAgY2FyZHNBcnJheSA9IGNhcmRzO1xuICAgIHJlbG9hZENhcmRzKCk7XG4gICAgcHJvZmlsZVRpdGxlRWwudGV4dENvbnRlbnQgPSB1c2VyLm5hbWU7XG4gICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xuICAgIHByb2ZpbGVBdmF0YXJFbC5zcmMgPSB1c2VyLmF2YXRhcjtcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuXG4vLyBBdmF0YXIgZm9ybSBlbGVtZW50c1xuY29uc3QgZWRpdEF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcbmNvbnN0IGVkaXRBdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xuY29uc3QgZWRpdEF2YXRhckNsb3NlQnRuID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGVkaXRBdmF0YXJGb3JtID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBlZGl0QXZhdGFyU3VibWl0QnRuID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XG5jb25zdCBlZGl0QXZhdGFySW5wdXQgPSBlZGl0QXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG4vLyBFZGl0IHByb2ZpbGUgZWxlbWVudHNcbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlQ2xvc2VCdG4gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IGVkaXRQcm9maWxlU3VibWl0QnRuID1cbiAgZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiXG4pO1xuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5cbmNvbnN0IHByb2ZpbGVUaXRsZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuLy8gQ2FyZCBmb3JtIGVsZW1lbnRzXG5jb25zdCBuZXdQb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uZXctcG9zdC1idG5cIik7XG5jb25zdCBuZXdQb3N0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1wb3N0LW1vZGFsXCIpO1xuY29uc3QgbmV3UG9zdENsb3NlQnRuID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcbmNvbnN0IG5ld1Bvc3RTdWJtaXRCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcbmNvbnN0IG5ld1Bvc3RGb3JtID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBuZXdQb3N0Q2FyZEltYWdlTGlua0lucHV0ID1cbiAgbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZS1pbnB1dFwiKTtcbmNvbnN0IG5ld1Bvc3RDYXJkQ2FwdGlvbklucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2NhcmQtY2FwdGlvbi1pbnB1dFwiXG4pO1xuXG4vLyBQcmV2aWV3IGltYWdlIHBvcHVwIGVsZW1lbnRzXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmNvbnN0IHByZXZpZXdJbWFnZUNsb3NlQnRuID1cbiAgcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgcHJldmlld0ltYWdlID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3SW1hZ2VDYXB0aW9uID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuLy8gQ29uZmlybWF0aW9uIHBvcHVwIGVsZW1lbnRzXG5cbmNvbnN0IGNvbmZpcm1hdGlvbk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjb25maXJtYXRpb24tbW9kYWxcIik7XG5jb25zdCBjb25maXJtYXRpb250Rm9ybSA9IGNvbmZpcm1hdGlvbk1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbmxldCBzZWxlY3RlZENhcmQsIHNlbGVjdGVkQ2FyZElkO1xuXG4vLyBDYXJkcyByZWxhdGVkIGVsZW1lbnRzXG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpXG4gIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlTGluayA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG5cbiAgY2FyZEltYWdlTGluay5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUxpbmsuc2V0QXR0cmlidXRlKFwiYWx0XCIsIGRhdGEubmFtZSk7XG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcblxuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGlmIChkYXRhLmlzTGlrZWQpIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9hY3RpdmVcIik7XG4gIGNhcmRMaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiBoYW5kbGVMaWtlQnRuQ2xpY2soZXZ0LCBkYXRhKSk7XG5cbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICBoYW5kbGVEZWxldGVCdG5DbGljayhjYXJkRWxlbWVudCwgZGF0YSlcbiAgKTtcblxuICBjYXJkSW1hZ2VMaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJldmlld0ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3SW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdJbWFnZU1vZGFsKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG5wcmV2aWV3SW1hZ2VDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKHByZXZpZXdJbWFnZU1vZGFsKTtcbn0pO1xuXG4vLyBPcGVuIGFuZCBjbG9zZSBtb2RhbHMgZnVuY3Rpb25zXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX2lzLW9wZW5lZFwiKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGNsb3NlT25Fc2NhcGUpO1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlT25PdmVybGF5Q2xpY2spO1xufVxuXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9pcy1vcGVuZWRcIik7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBjbG9zZU9uRXNjYXBlKTtcbiAgbW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbG9zZU9uT3ZlcmxheUNsaWNrKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VPbkVzY2FwZShldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpO1xuICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNsb3NlT25PdmVybGF5Q2xpY2soZXZ0KSB7XG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XG4gICAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcbiAgfVxufVxuXG4vLyBFZGl0IHByb2ZpbGUgb3Blbi9jbG9zZSBtb2RhbCBhbmQgaGFuZGxlIGZvcm0gc3VibWlzc2lvblxuXG5lZGl0UHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBlZGl0UHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVUaXRsZUVsLnRleHRDb250ZW50O1xuICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb25FbC50ZXh0Q29udGVudDtcbiAgaGlkZUlucHV0RXJyb3IoZWRpdFByb2ZpbGVNb2RhbCwgZWRpdFByb2ZpbGVOYW1lSW5wdXQsIHNldHRpbmdzKTtcbiAgaGlkZUlucHV0RXJyb3IoZWRpdFByb2ZpbGVNb2RhbCwgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0LCBzZXR0aW5ncyk7XG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdChldnQpIHtcbiAgaWYgKCFlZGl0UHJvZmlsZUZvcm0uY2hlY2tWYWxpZGl0eSgpKSByZXR1cm47XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcblxuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IGVkaXRQcm9maWxlTmFtZUlucHV0LnZhbHVlLFxuICAgICAgYWJvdXQ6IGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKCh1cGRhdGVkVXNlcikgPT4ge1xuICAgICAgcHJvZmlsZVRpdGxlRWwudGV4dENvbnRlbnQgPSB1cGRhdGVkVXNlci5uYW1lO1xuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uRWwudGV4dENvbnRlbnQgPSB1cGRhdGVkVXNlci5hYm91dDtcbiAgICAgIGVkaXRQcm9maWxlU3VibWl0QnRuLmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5hY3RpdmVCdG5DbGFzcyk7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZWRpdFByb2ZpbGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdFByb2ZpbGVTdWJtaXQpO1xuXG5lZGl0UHJvZmlsZUNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxuLy8gQ2FyZCBvcGVuL2Nsb3NlIG1vZGFsIGFuZCBoYW5kbGUgZm9ybSBzdWJtaXNzaW9uXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZU5ld1Bvc3RTdWJtaXQoZXZ0KSB7XG4gIGlmICghbmV3UG9zdEZvcm0uY2hlY2tWYWxpZGl0eSgpKSByZXR1cm47XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcblxuICBhcGlcbiAgICAuY3JlYXRlTmV3Q2FyZCh7XG4gICAgICBuYW1lOiBuZXdQb3N0Q2FyZENhcHRpb25JbnB1dC52YWx1ZSxcbiAgICAgIGxpbms6IG5ld1Bvc3RDYXJkSW1hZ2VMaW5rSW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxuICAgICAgICBsaW5rOiBjYXJkLmxpbmssXG4gICAgICB9O1xuICAgICAgLy9jb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGRhdGEpO1xuICAgICAgY2FyZHNBcnJheS51bnNoaWZ0KGNhcmQpO1xuICAgICAgY2FyZHNMaXN0LmlubmVySFRNTCA9IFwiXCI7XG4gICAgICByZWxvYWRDYXJkcygpO1xuICAgICAgLy9jYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gICAgICBuZXdQb3N0U3VibWl0QnRuLmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5hY3RpdmVCdG5DbGFzcyk7XG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gICAgICBjbG9zZU1vZGFsKG5ld1Bvc3RNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG5uZXdQb3N0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RTdWJtaXQpO1xuXG5uZXdQb3N0Q2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xufSk7XG5cbi8vIEF2YXRhciBvcGVuL2Nsb3NlIG1vZGFsIGFuZCBoYW5kbGUgZm9ybSBzdWJtaXNzaW9uXG5lZGl0QXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChlZGl0QXZhdGFyTW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRBdmF0YXJTdWJtaXQoZXZ0KSB7XG4gIGlmICghZWRpdEF2YXRhckZvcm0uY2hlY2tWYWxpZGl0eSgpKSByZXR1cm47XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSk7XG4gIGFwaVxuICAgIC5lZGl0QXZhdGFyKGVkaXRBdmF0YXJJbnB1dC52YWx1ZSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgcHJvZmlsZUF2YXRhckVsLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgZWRpdEF2YXRhclN1Ym1pdEJ0bi5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmluYWN0aXZlQnRuQ2xhc3MpO1xuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgY2xvc2VNb2RhbChlZGl0QXZhdGFyTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZWRpdEF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0QXZhdGFyU3VibWl0KTtcblxuZWRpdEF2YXRhckNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcbn0pO1xuXG4vLyBDb25maXJtYXRpb24gb3Blbi9jbG9zZSBtb2RhbCBhbmQgaGFuZGxlIGZvcm0gc3VibWlzc2lvblxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVCdG5DbGljayhjYXJkRWxlbWVudCwgZGF0YSkge1xuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcbiAgY29uc29sZS5sb2coc2VsZWN0ZWRDYXJkSWQpO1xuICBvcGVuTW9kYWwoY29uZmlybWF0aW9uTW9kYWwpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSk7XG5cbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgLy8gc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY29uc3QgaW5kZXggPSBjYXJkc0FycmF5LmZpbmRJbmRleCgoY2FyZCkgPT4gY2FyZC5faWQgPT09IHNlbGVjdGVkQ2FyZElkKTtcbiAgICAgIGNhcmRzQXJyYXkuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIGNhcmRzTGlzdC5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgcmVsb2FkQ2FyZHMoKTtcbiAgICAgIHNlbGVjdGVkQ2FyZCA9IFwiXCI7XG4gICAgICBzZWxlY3RlZENhcmRJZCA9IFwiXCI7XG4gICAgICBjbG9zZU1vZGFsKGNvbmZpcm1hdGlvbk1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSk7XG4gICAgfSk7XG59XG5cbmNvbmZpcm1hdGlvbnRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdCk7XG5cbmNvbmZpcm1hdGlvbk1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICBpZiAoXG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnRuXCIpIHx8XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbGVfX3N1Ym1pdC1idG5fdHlwZV9jYW5jZWxcIilcbiAgKSB7XG4gICAgc2VsZWN0ZWRDYXJkID0gXCJcIjtcbiAgICBzZWxlY3RlZENhcmRJZCA9IFwiXCI7XG4gICAgY2xvc2VNb2RhbChjb25maXJtYXRpb25Nb2RhbCk7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQnRuQ2xpY2soZXZ0LCBkYXRhKSB7XG4gIC8vY29uc3QgaXNMaWtlZCA9IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpO1xuICBhcGlcbiAgICAudG9nZ2xlTGlrZShkYXRhLl9pZCwgZGF0YS5pc0xpa2VkKSAvLyBpc0xpa2VkKVxuICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSBjYXJkc0FycmF5LmZpbmRJbmRleCgoY2FyZCkgPT4gY2FyZC5faWQgPT09IGRhdGEuX2lkKTtcblxuICAgICAgY2FyZHNBcnJheVtpbmRleF0gPSB1cGRhdGVkQ2FyZDtcbiAgICAgIGNhcmRzTGlzdC5pbm5lckhUTUwgPSBcIlwiO1xuICAgICAgcmVsb2FkQ2FyZHMoKTtcbiAgICAgIC8vZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fYWN0aXZlXCIpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xufVxuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0YWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICBnZXRJbml0YWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBlZGl0QXZhdGFyKGxpbmspIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgY3JlYXRlTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHRvZ2dsZUxpa2UoY2FyZElkLCBpc0xpa2VkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdG5TZWxlY3RvciIsImluYWN0aXZlQnRuQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdG5TdGF0ZSIsImlucHV0TGlzdCIsImJ0bkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImFkZCIsImRpc2FibGVkIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsInRleHQiLCJ0cmltIiwic2xpY2UiLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsImVkaXRVc2VySW5mbyIsIm5hbWUiLCJhYm91dCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhciIsImxpbmsiLCJhdmF0YXIiLCJjcmVhdGVOZXdDYXJkIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsInRvZ2dsZUxpa2UiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzQXJyYXkiLCJyZWxvYWRDYXJkcyIsImZvckVhY2giLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJkYXRhIiwiY2FyZFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlTGluayIsInNyYyIsInNldEF0dHJpYnV0ZSIsImNhcmRMaWtlQnRuIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsIl9pZCIsInVwZGF0ZWRDYXJkIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJjYXJkc0xpc3QiLCJpbm5lckhUTUwiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImhhbmRsZUxpa2VCdG5DbGljayIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwibG9nIiwib3Blbk1vZGFsIiwiY29uZmlybWF0aW9uTW9kYWwiLCJoYW5kbGVEZWxldGVCdG5DbGljayIsInByZXZpZXdJbWFnZUNhcHRpb24iLCJwcmV2aWV3SW1hZ2UiLCJhbHQiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsImdldENhcmRFbGVtZW50IiwiYXBwZW5kIiwiY2FyZHMiLCJ1c2VyIiwicHJvZmlsZVRpdGxlRWwiLCJwcm9maWxlRGVzY3JpcHRpb25FbCIsInByb2ZpbGVBdmF0YXJFbCIsImVkaXRBdmF0YXJCdG4iLCJkb2N1bWVudCIsImVkaXRBdmF0YXJNb2RhbCIsImVkaXRBdmF0YXJDbG9zZUJ0biIsImVkaXRBdmF0YXJGb3JtIiwiZWRpdEF2YXRhclN1Ym1pdEJ0biIsImVkaXRBdmF0YXJJbnB1dCIsImVkaXRQcm9maWxlQnRuIiwiZWRpdFByb2ZpbGVNb2RhbCIsImVkaXRQcm9maWxlQ2xvc2VCdG4iLCJlZGl0UHJvZmlsZVN1Ym1pdEJ0biIsImVkaXRQcm9maWxlRm9ybSIsImVkaXRQcm9maWxlTmFtZUlucHV0IiwiZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwibmV3UG9zdEJ0biIsIm5ld1Bvc3RNb2RhbCIsIm5ld1Bvc3RDbG9zZUJ0biIsIm5ld1Bvc3RTdWJtaXRCdG4iLCJuZXdQb3N0Rm9ybSIsIm5ld1Bvc3RDYXJkSW1hZ2VMaW5rSW5wdXQiLCJuZXdQb3N0Q2FyZENhcHRpb25JbnB1dCIsInByZXZpZXdJbWFnZUNsb3NlQnRuIiwiY29uZmlybWF0aW9udEZvcm0iLCJjb250ZW50IiwibW9kYWwiLCJjbG9zZU9uRXNjYXBlIiwiY2xvc2VPbk92ZXJsYXlDbGljayIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJ2YWx1ZSIsImNoZWNrVmFsaWRpdHkiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdEJ0biIsInN1Ym1pdHRlciIsInVwZGF0ZWRVc2VyIiwiZmluYWxseSIsInVuc2hpZnQiLCJyZXNldCIsInNwbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9